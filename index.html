<!DOCTYPE html>
<html>
  <head>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
      }

      canvas {
        display: block;
        width: 100%;
        height: 100%;
        background-color: black;
      }
    </style>
    <script defer type="module" src="./ship.js"></script>
    <script defer type="module" src="./stars.js"></script>
  </head>
  <body>
    <canvas id="myCanvas"></canvas>

    <script type="module">
      import { createShip } from "./ship.js";
      import { animateLoop } from "./animationLoop.js";
      const canvas = document.getElementById("myCanvas");
      const ctx = canvas.getContext("2d");
      let size;
      const ship = createShip(
        canvas,
        Math.min(canvas.width, canvas.height) * 0.1
      );

      const rotationSpeed = 0.05;
      const acceleration = 0.1;

      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        size = Math.min(canvas.width, canvas.height) * 0.1;
        ship.size = size * 1;
        // add ship x and y to resize
        ship.x = canvas.width / 2;
        ship.y = canvas.height / 2;
        // drawTriangle(canvas, ctx, size);
      }

      window.addEventListener("resize", resizeCanvas);

      resizeCanvas();

      animateLoop(
        canvas,
        ctx,
        // () => drawTriangle(canvas, ctx, size))
        () => {
          ship.draw(ctx);
          ship.update();
        }
      );
      document.addEventListener("keydown", (event) => {
        switch (event.key) {
          case "ArrowLeft":
            ship.rotation -= rotationSpeed;
            break;
          case "ArrowRight":
            ship.rotation += rotationSpeed;
            break;
          case "ArrowUp":
            ship.vx += acceleration * Math.sin(ship.rotation);
            ship.vy -= acceleration * Math.cos(ship.rotation);
            // add in acceleration factor
            ship.accelerating = 1;
            console.log("acceleration is 1");
            break;
          case "ArrowDown":
            ship.vx -= acceleration * Math.sin(ship.rotation);
            ship.vy += acceleration * Math.cos(ship.rotation);
            // add in acceleration factor
            ship.accelerating = -1;
            console.log("acceleration is -1");
            break;
        }
      });
      document.addEventListener("keyup", (event) => {
        if (event.key === "ArrowUp" || event.key === "ArrowDown") {
          ship.accelerating = 0;
        }
      });
    </script>
  </body>
</html>
